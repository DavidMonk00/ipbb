---
.template_setup:
  stage: setup
  tags:
    - docker



setup_cc7_py2_venv:
  extends: .template_setup
  image: ${IPBUS_DOCKER_REGISTRY}/ipbb-dev-cc7:dev-ipbb-imgs__uhal2.7.2
  # before_script:
    # - yum install -y python2-pip python-virtualenv gcc
  script:
    - source env.sh
    - ipbb --version
  artifacts:
    when: on_success
    paths:
      - venv/ipbb
      - src/ipbb.egg-info
    expire_in: 1 hour


setup_cc7_py2_sys:
  extends: .template_setup
  image: ${IPBUS_DOCKER_REGISTRY}/ipbb-dev-cc7:dev-ipbb-imgs__uhal2.7.2
  # before_script:
    # - yum install -y python2-pip python-virtualenv gcc
    # - pip install -U pip 'setuptools==41.2.0'
  script:
    - sudo pip install .
    - ipbb --version


setup_cc8_py3_venv:
  extends: .template_setup
  image: ${IPBUS_DOCKER_REGISTRY}/ipbb-dev-centos8:dev-ipbb-imgs__uhal2.7.2
  # before_script:
    # - yum install -y gcc python36-devel python3-pip 
    # - alternatives --set python /usr/bin/python3
  script:
    - source env.sh
    - ipbb --version


setup_cc8_py3_sys:
  extends: .template_setup
  image: c${IPBUS_DOCKER_REGISTRY}/ipbb-dev-centos8:dev-ipbb-imgs__uhal2.7.2
  # before_script:
    # - yum install -y gcc python36-devel python3-pip 
    # - alternatives --set python /usr/bin/python3
    # - pip-3 install -U pip setuptools
  script:
    - sudo pip install .
    - ipbb --version

